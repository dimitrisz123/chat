(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,n){},259:function(e,t,n){},260:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(14),s=n.n(r),c=(n(103),n(15)),i=n(16),u=n(18),l=n(17),m=n(19),p=n(29),d=n.n(p),g=n(28),h=n.n(g),f=n(46),b=n.n(f),E=n(47),v=n.n(E),y=n(30),O=n.n(y),j=n(45),w=n.n(j),R={button:{margin:"20px auto"}},k=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).onUsernameChangeHandler=function(t){e.setState({UsernameInput:t.target.value})},e.onPasswordChangeHandler=function(t){e.setState({PasswordInput:t.target.value})},e.onLoginPressButton=function(){fetch("https://chatback123.herokuapp.com/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userid:e.state.UsernameInput,pass:e.state.PasswordInput})}).then(function(e){return e.json()}).then(function(t){t.id&&(e.props.userHandler(t),e.props.changeRoute("app"))}).catch(function(e){return console.log("User not found")})},e.state={UsernameInput:"",PasswordInput:""},e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(h.a,{container:!0,justify:"center",alignItems:"center",style:{height:"100vh",backgroundImage:"url(".concat(w.a,")"),backgroundSize:"cover"}},o.a.createElement(b.a,{style:{width:"300px"}},o.a.createElement(h.a,{container:!0,direction:"column",alignItems:"center",justify:"space-around"},o.a.createElement(v.a,{title:"Login"}),o.a.createElement(d.a,{label:"Username",style:{width:"200px"},type:"text",margin:"normal",onChange:this.onUsernameChangeHandler}),o.a.createElement(d.a,{label:"Password",style:{width:"200px"},type:"password",margin:"normal",onChange:this.onPasswordChangeHandler}),o.a.createElement(O.a,{onClick:this.onLoginPressButton,style:R.button,variant:"contained"},"Login"),o.a.createElement(O.a,{style:{marginBottom:"20px"},size:"small",color:"primary",onClick:function(){return e.props.changeRoute("register")}},"Click here to register"))))}}]),t}(a.Component),M={button:{margin:"20px auto"}},S=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(l.a)(t).call(this))).onUsernameChangeHandler=function(t){e.setState({UsernameInput:t.target.value})},e.onPasswordChangeHandler=function(t){e.setState({PasswordInput:t.target.value})},e.onRegisterPressed=function(){fetch("https://chatback123.herokuapp.com/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userid:e.state.UsernameInput,pass:e.state.PasswordInput})}).then(function(e){return e.json()}).then(function(t){t.id&&e.props.userHandler(t)}).catch(function(e){return console.log("Register failed")})},e.state={UsernameInput:"",PasswordInput:""},e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(h.a,{container:!0,justify:"center",alignItems:"center",style:{height:"100vh",backgroundImage:"url(".concat(w.a,")"),backgroundSize:"cover"}},o.a.createElement(b.a,{style:{width:"300px"}},o.a.createElement(h.a,{container:!0,direction:"column",alignItems:"center",justify:"space-around"},o.a.createElement(v.a,{title:"Register"}),o.a.createElement(d.a,{label:"Username",style:{width:"200px"},type:"text",margin:"normal",onChange:this.onUsernameChangeHandler}),o.a.createElement(d.a,{label:"Password",style:{width:"200px"},type:"password",margin:"normal",onChange:this.onPasswordChangeHandler}),o.a.createElement(O.a,{onClick:this.onRegisterPressed,style:M.button,variant:"contained"},"Register"),o.a.createElement(O.a,{style:{marginBottom:"20px"},size:"small",color:"primary",onClick:function(){return e.props.changeRoute("login")}},"Click here to login"))))}}]),t}(a.Component),I=n(32),C=n(60),T=function(e){return o.a.createElement("div",{className:"add-room"},o.a.createElement("form",{onSubmit:e.createRoom},o.a.createElement("input",{placeholder:"Enter a room name",className:"input",type:"text",onChange:e.inputRoom,value:e.value})))},N=function(e){return o.a.createElement("div",{className:"message-list"},e.messages.map(function(e,t){return o.a.createElement("div",{className:"message",key:t},o.a.createElement("div",{className:"message-username"},e.senderId),o.a.createElement("div",{className:"message-text"},e.parts[0].payload.content))}))},U=function(e){var t=e.sendMessage,n=e.inputMessage,a=e.value,r=e.disabled;return o.a.createElement("form",{className:"input",onSubmit:t},o.a.createElement("input",{placeholder:"Enter a message",className:"input",type:"text",onChange:n,value:a,disabled:r}))},P=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=Object(I.a)(this.props.rooms).sort(function(e,t){return e.id-t.id});return o.a.createElement("div",{className:"rooms-list"},o.a.createElement("ul",null,t.map(function(t,n){return o.a.createElement("li",{className:"room",key:n},o.a.createElement("a",{onClick:function(){return e.props.subscribeToRoom(t.id)},href:"# "},t.name))})))}}]),t}(o.a.Component),_=n(27),x=function(e){return"message"===e?{type:"CLEAR_MESSAGE_INPUT"}:"room"===e?{type:"CLEAR_ROOM_INPUT"}:void 0},H=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).subscribeToRoom=function(e){n.props.allMessages([]),n.props.getRoomId(e),n.currentUser.subscribeToRoomMultipart({roomId:e,hooks:{onMessage:function(e){n.props.allMessages([].concat(Object(I.a)(n.props.messages),[e]))}},messageLimit:10}).catch(function(e){return console.log("something went wrong")})},n.getAllRooms=function(){n.currentUser.getJoinableRooms().then(function(e){n.props.allRooms([].concat(Object(I.a)(e),Object(I.a)(n.currentUser.rooms)))}).catch(function(e){console.log("Error getting joinable rooms: ".concat(e))})},n.createRoom=function(e){e.preventDefault(),n.currentUser.createRoom({name:n.props.roomName}).then(function(e){e&&(n.props.clearRoomInput(),n.getAllRooms(),n.subscribeToRoom(e.id))}).catch(function(e){console.log("Error creating room ".concat(e))})},n.sendMessage=function(e){e.preventDefault(),n.currentUser.sendSimpleMessage({text:n.props.inputMessage,roomId:n.props.roomid}).then(function(e){console.log(e),e&&n.props.clearMessageInput()}).catch(function(e){console.log("Error adding message to my room: ".concat(e))})},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;new C.ChatManager({instanceLocator:"v1:us1:70765878-2ac8-4e66-938d-b18c7503aded",userId:this.props.user.id,tokenProvider:new C.TokenProvider({url:"https://chatback123.herokuapp.com/auth"})}).connect().then(function(t){e.currentUser=t,e.getAllRooms()}).catch(function(e){console.log("Error on connection",e)})}},{key:"render",value:function(){var e=this.props,t=e.onInputMessage,n=e.onInputRoom,a=e.roomName,r=e.inputMessage,s=e.rooms,c=e.messages,i=e.roomid;return o.a.createElement("div",{className:"app"},o.a.createElement("div",{className:"top-row"},o.a.createElement(P,{subscribeToRoom:this.subscribeToRoom,rooms:s}),o.a.createElement(N,{messages:c})),o.a.createElement("div",{className:"bottom-row"},o.a.createElement(T,{createRoom:this.createRoom,inputRoom:n,value:a}),o.a.createElement(U,{disabled:!i,sendMessage:this.sendMessage,inputMessage:t,value:r})))}}]),t}(a.Component),A=Object(_.b)(function(e){return{inputMessage:e.reducer1.inputMessage,roomName:e.reducer1.roomName,messages:e.reducer1.messages,rooms:e.reducer1.rooms,roomid:e.reducer1.roomid}},function(e){return{onInputMessage:function(t){return e({type:"SET_MESSAGE",payload:t.target.value})},onInputRoom:function(t){return e({type:"SET_ROOM",payload:t.target.value})},allMessages:function(t){return e({type:"GET_MESSAGES",payload:t})},allRooms:function(t){return e({type:"GET_ROOMS",payload:t})},getRoomId:function(t){return e(function(e){return{type:"GET_ROOM_ID",payload:e}}(t))},clearMessageInput:function(){return e(x("message"))},clearRoomInput:function(){return e(x("room"))}}})(H),G=(n(259),function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){fetch("https://chatback123.herokuapp.com/")}},{key:"render",value:function(){var e,t=this.props,n=t.changeRouteHandler,a=t.userHandler,r=t.user,s=t.route;return"register"===s?e=o.a.createElement(S,{changeRoute:n,userHandler:a}):"login"===s?e=o.a.createElement(k,{userHandler:a,changeRoute:n}):"app"===s&&(e=o.a.createElement(A,{user:r})),o.a.createElement("div",null,e)}}]),t}(a.Component)),L=Object(_.b)(function(e){return{route:e.reducer1.route,user:e.reducer1.user}},function(e){return{changeRouteHandler:function(t){return e(function(e){return{type:"SET_ROUTE",payload:e}}(t))},userHandler:function(t){return e({type:"SET_USER",payload:t})}}})(G),B=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function D(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var J=n(97),W=n.n(J),z=n(31),Q={inputMessage:"",roomName:"",route:"login",user:"",messages:[],rooms:[],roomid:null},$=Object(z.c)({reducer1:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_MESSAGE":return Object.assign({},e,{inputMessage:t.payload});case"SET_ROOM":return Object.assign({},e,{roomName:t.payload});case"SET_ROUTE":return Object.assign({},e,{route:t.payload});case"SET_USER":return Object.assign({},e,{user:t.payload});case"GET_MESSAGES":return Object.assign({},e,{messages:t.payload});case"GET_ROOMS":return Object.assign({},e,{rooms:t.payload});case"GET_ROOM_ID":return Object.assign({},e,{roomid:t.payload});case"CLEAR_MESSAGE_INPUT":return Object.assign({},e,{inputMessage:Q.inputMessage});case"CLEAR_ROOM_INPUT":return Object.assign({},e,{roomName:Q.roomName});default:return e}}}),q=Object(z.d)($,Object(z.a)(W.a));s.a.render(o.a.createElement(_.a,{store:q},o.a.createElement(L,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/chat",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/chat","/service-worker.js");B?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):D(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):D(e)})}}()},45:function(e,t,n){e.exports=n.p+"static/media/photo1.aa57deaa.jpg"},98:function(e,t,n){e.exports=n(260)}},[[98,1,2]]]);
//# sourceMappingURL=main.d41dd92a.chunk.js.map